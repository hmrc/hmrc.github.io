<!DOCTYPE html>
<html lang="en" class="govuk-template">
  <head>
    <meta charset="utf-8">
    <title>Handling secrets - HM Revenue & Customs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0b0c0c">

<link rel="shortcut icon" sizes="16x16 32x32 48x48" href="/assets/images/favicon.ico" type="image/x-icon"><link rel="mask-icon" href="/assets/images/govuk-mask-icon.svg" color="#0b0c0c"><link rel="apple-touch-icon" href="/assets/images/govuk-apple-touch-icon.png">
  <link rel="stylesheet" href="/assets/govuk.css">
  <link rel="stylesheet" href="/css/base.css">


  <meta property="og:title" content="Handling secrets">

  </head>
  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

      <a href="#main-content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>


  <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-width-container app-header__container">
    <div class="govuk-header__logo app-header__logo">
      <a href="/" class="govuk-header__link govuk-header__link--homepage">
          <span class="govuk-header__logotype">  <img src="/assets/hmrc_crest_18px_x2.png" height="34px" alt="HM Revenue & Customs logo">  <span class="govuk-header__logotype-text">HM Revenue & Customs</span></span>
        <span class="govuk-header__product-name">
          Engineering Guidance
        </span>
      </a>
    </div>
    <site-search class="app-site-search govuk-!-display-none-print" index="/search.json" label="Search site"><a class="app-site-search__link" href="/sitemap.html">Sitemap</a></site-search>

  </div>
</header>

  

      <div class="govuk-width-container">
  <nav class="govuk-breadcrumbs govuk-!-display-none-print" aria-label="Breadcrumb">
  <ol class="govuk-breadcrumbs__list">
    <li class="govuk-breadcrumbs__list-item">
      <a class="govuk-breadcrumbs__link" href="/">Home</a>
    </li>
    <li class="govuk-breadcrumbs__list-item">
      <a class="govuk-breadcrumbs__link" href="/standards/">Standards</a>
    </li>
  </ol>
</nav>

        <main class="govuk-main-wrapper" id="main-content">
  <header class="app-document-header">
  <h1 class="app-document-header__title govuk-heading-xl">
    Handling secrets
  </h1>

</header>



  <div class="app-prose-scope"><p class="govuk-body-s">
Last updated: 22 April 2025
</p>
<p class="govuk-body-l">
Secrets, such as usernames and API keys, must be handled appropriately to prevent serious events such as data loss or unauthorised access.
</p>
<hr class="govuk-section-break--l govuk-section-break--visible">
<h2 id="requirement(s)" tabindex="-1" class="govuk-heading-l">Requirement(s)</h2>
<ul class="govuk-list govuk-list--bullet">
<li><a href="#you-must-not-include-secrets-in-source-code" class="govuk-link">You MUST not include secrets in source code</a></li>
<li><a href="#you-must-limit-the-scope-of-secrets" class="govuk-link">You MUST limit the scope of secrets</a></li>
<li><a href="#you-must-be-able-to-rotate-secret-keys" class="govuk-link">You MUST be able to rotate secret keys</a></li>
<li><a href="#you-must-secure-secrets-appropriately" class="govuk-link">You MUST secure secrets appropriately</a></li>
</ul>
<h3 id="you-must-not-include-secrets-in-source-code" tabindex="-1" class="govuk-heading-m">You MUST not include secrets in source code</h3>
<p class="govuk-body">By using tooling to provide software with secrets at deployment time, rather than hard-coding them in source code, you significantly reduce the scope for secrets to be accidentally disclosed because they are only exposed to the software itself rather than engineers.</p>
<p class="govuk-body">This also allows you to change values of secrets more quickly, as you are not bound to creating a new release version of the software to change a secret – you can change the secret and redeploy the same version of the software.</p>
<h3 id="you-must-limit-the-scope-of-secrets" tabindex="-1" class="govuk-heading-m">You MUST limit the scope of secrets</h3>
<p class="govuk-body">The value of a secret must be limited in scope as much as is reasonable. For example, secrets should not be shared across different deployment environments and should only provide access to the limited set of specific resources needed for a given service. This reduces the impact of secret disclosures by reducing what an unauthorised party can use the secret for.</p>
<p class="govuk-body">If a secret needs to be revoked and rotated, having granular secrets that are per-environment and per-service can greatly minimise the time needed to restore the service and reduces the impact on other services.</p>
<h3 id="you-must-be-able-to-rotate-secret-keys" tabindex="-1" class="govuk-heading-m">You MUST be able to rotate secret keys</h3>
<p class="govuk-body">You need to be able to rotate secrets – either as part of a periodic process or in response to a known or suspected disclosure. The process for this should be well-documented and understood by all required parties. Where possible, you should automate this process to reduce the need for engineers to handle secret values.</p>
<h3 id="you-must-secure-secrets-appropriately" tabindex="-1" class="govuk-heading-m">You MUST secure secrets appropriately</h3>
<p class="govuk-body">Secret values should be appropriately protected. For example, you may use a secret management tool that restricts access to secret values through role-based access controls, and only provide access to the relevant software itself.</p>
<p class="govuk-body">You may also encrypt secrets using a suitable encryption algorithm, however this means you must then consider how and when to rotate the encryption key, and how to store that key securely.</p>
</div>



        </main>
      </div>

  <footer class="govuk-footer app-footer " role="contentinfo">
  <div class="govuk-width-container ">
    <div class="govuk-footer__meta">
      <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">
          <h2 class="govuk-visually-hidden">Support links</h2>
            <ul class="govuk-footer__inline-list">
                <li class="govuk-footer__inline-list-item">
                  <a class="govuk-footer__link" href="/cookies/">
                    Cookies
                  </a>
                </li>
                <li class="govuk-footer__inline-list-item">
                  <a class="govuk-footer__link" href="/accessibility-statement/">
                    Accessibility statement
                  </a>
                </li>
                <li class="govuk-footer__inline-list-item">
                  <a class="govuk-footer__link" href="https://github.com/hmrc/hmrc.github.io">
                    Github repository
                  </a>
                </li>
            </ul>
<svg class="govuk-footer__licence-logo" aria-hidden="true" focusable="false" height="17" width="41" viewBox="0 0 483.2 195.7" xmlns="http://www.w3.org/2000/svg">
  <path fill="currentColor" d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"/>
</svg>
          <span class="govuk-footer__licence-description">
            All content is available under the <a class="govuk-footer__link" href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated
          </span>
      </div><div class="govuk-footer__meta-item">© <a class="govuk-footer__link govuk-footer__copyright-logo" href="https://github.com/hmrc/engineering-site-spike/LICENCE">Crown copyright (HM Revenue & Customs)</a>
        </div>
    </div>
  </div>
</footer>


  <script src="/assets/govuk.js" type="module"></script>
  </body>
</html>
